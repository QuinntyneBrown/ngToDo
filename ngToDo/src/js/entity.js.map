{"version":3,"sources":["entity.ts"],"names":["app","app.common","app.common.Entity","app.common.Entity.constructor","app.common.Entity.notifyChanged","app.common.Entity.notify"],"mappings":"AAAA,IAAO,GAAG,CAoIT;AApID,WAAO,GAAG;IAACA,IAAAA,MAAMA,CAoIhBA;IApIUA,WAAAA,MAAMA,EAACA,CAACA;QAEfC,IAAaA,MAAMA;YAEfC,SAFSA,MAAMA,CAEIA,SAASA,EAASA,EAAgBA,EAAUA,WAAgCA,EAASA,OAAeA;gBAF3HC,iBAiICA;gBA/HsBA,cAASA,GAATA,SAASA,CAAAA;gBAASA,OAAEA,GAAFA,EAAEA,CAAcA;gBAAUA,gBAAWA,GAAXA,WAAWA,CAAqBA;gBAASA,YAAOA,GAAPA,OAAOA,CAAQA;gBAShHA,YAAOA,GAAGA,UAACA,EAAMA;oBAEpBA,IAAIA,QAAQA,GAAGA,KAAIA,CAACA,EAAEA,CAACA,KAAKA,EAAEA,CAACA;oBAE/BA,KAAIA,CAACA,WAAWA,CAACA,OAAOA,CAACA,EAAEA,CAACA,CAACA,IAAIA,CAACA,UAACA,OAAOA;wBACtCA,IAAIA,MAAMA,GAAKA,IAAIA,CAACA;wBAEpBA,KAAIA,CAACA,QAAQA,CAACA,OAAOA,CAACA,IAAIA,CAACA,CAACA,IAAIA,CAACA,UAACA,OAAOA;4BACrCA,MAAMA,GAAGA,OAAOA,CAACA;4BACjBA,QAAQA,CAACA,OAAOA,CAACA,MAAMA,CAACA,CAACA;wBAC7BA,CAACA,CAACA,CAACA;oBAGPA,CAACA,CAACA,CAACA;oBAEHA,MAAMA,CAACA,QAAQA,CAACA,OAAOA,CAACA;gBAC5BA,CAACA,CAAAA;gBAEMA,WAAMA,GAAGA;oBAEZA,IAAIA,QAAQA,GAAGA,KAAIA,CAACA,EAAEA,CAACA,KAAKA,EAAEA,CAACA;oBAE/BA,KAAIA,CAACA,WAAWA,CAACA,MAAMA,EAAEA,CAACA,IAAIA,CAACA,UAACA,OAAOA;wBACnCA,IAAIA,QAAQA,GAAGA,EAAEA,CAACA;wBAElBA,IAAIA,QAAQA,GAAGA,EAAEA,CAACA;wBAElBA,GAAGA,CAACA,CAACA,GAAGA,CAACA,CAACA,GAAGA,CAACA,EAAEA,CAACA,GAAGA,OAAOA,CAACA,IAAIA,CAACA,MAAMA,EAAEA,CAACA,EAAEA,EAAEA,CAACA;4BAC3CA,QAAQA,CAACA,IAAIA,CAACA,KAAIA,CAACA,QAAQA,CAACA,OAAOA,CAACA,IAAIA,CAACA,CAACA,CAACA,CAACA,CAACA,CAACA;wBAClDA,CAACA;wBAEDA,KAAIA,CAACA,EAAEA,CAACA,GAAGA,CAACA,QAAQA,CAACA,CAACA,IAAIA,CAACA,UAACA,UAAUA;4BAClCA,GAAGA,CAACA,CAACA,GAAGA,CAACA,CAACA,GAAGA,CAACA,EAAEA,CAACA,GAAGA,UAAUA,CAACA,MAAMA,EAAEA,CAACA,EAAEA,EAAEA,CAACA;gCACzCA,QAAQA,CAACA,IAAIA,CAACA,UAAUA,CAACA,CAACA,CAACA,CAACA,CAACA;4BACjCA,CAACA;4BACDA,QAAQA,CAACA,OAAOA,CAACA,QAAQA,CAACA,CAACA;wBAC/BA,CAACA,CAACA,CAACA;oBACPA,CAACA,CAACA,CAACA;oBAEHA,MAAMA,CAACA,QAAQA,CAACA,OAAOA,CAACA;gBAC5BA,CAACA,CAAAA;gBAEMA,SAAIA,GAAGA;oBAEVA,IAAIA,QAAQA,GAAGA,KAAIA,CAACA,EAAEA,CAACA,KAAKA,EAAEA,CAACA;oBAC/BA,IAAIA,OAAOA,GAAGA,KAAIA,CAACA;oBACnBA,IAAIA,QAAQA,GAAGA,EAAEA,CAACA;oBAClBA,EAAEA,CAACA,CAACA,KAAIA,CAACA,OAAOA,EAAEA,CAACA,CAACA,CAACA;wBACjBA,EAAEA,CAACA,CAACA,KAAIA,CAACA,EAAEA,CAACA,CAACA,CAACA;4BACVA,QAAQA,CAACA,IAAIA,CAACA,KAAIA,CAACA,WAAWA,CAACA,MAAMA,CAACA,KAAIA,CAACA,CAACA,CAACA;wBACjDA,CAACA;wBAACA,IAAIA,CAACA,CAACA;4BACJA,QAAQA,CAACA,IAAIA,CAACA,KAAIA,CAACA,WAAWA,CAACA,GAAGA,CAACA,KAAIA,CAACA,CAACA,CAACA;wBAC9CA,CAACA;oBACLA,CAACA;oBAACA,IAAIA,CAACA,CAACA;wBACJA,QAAQA,CAACA,MAAMA,EAAEA,CAACA;oBACtBA,CAACA;oBAEDA,K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","file":"entity.js","sourceRoot":"C:/Projects/ngToDo/ngToDo/","sourcesContent":["module app.common {\r\n\r\n    export class Entity<T> implements IEntity<T> {\r\n\r\n        constructor(public $location, public $q: ng.IQService, private dataService: common.IDataService, public baseUri: string) {\r\n            this.id = 0;\r\n            this.isDeleted = false;\r\n        }\r\n\r\n        public id: number;\r\n\r\n        public isDeleted: boolean;\r\n\r\n        public getById = (id:any) => {\r\n\r\n            var deferred = this.$q.defer();\r\n\r\n            this.dataService.getById(id).then((results) => {\r\n                var entity:T = null;\r\n\r\n                this.instance(results.data).then((results) => {\r\n                    entity = results;\r\n                    deferred.resolve(entity);\r\n                });\r\n\r\n                \r\n            });\r\n\r\n            return deferred.promise;\r\n        }\r\n\r\n        public getAll = () => {\r\n\r\n            var deferred = this.$q.defer();\r\n\r\n            this.dataService.getAll().then((results) => {\r\n                var entities = [];\r\n\r\n                var promises = [];\r\n\r\n                for (var i = 0; i < results.data.length; i++) {\r\n                    promises.push(this.instance(results.data[i]));\r\n                }\r\n\r\n                this.$q.all(promises).then((allResults) => {\r\n                    for (var x = 0; x < allResults.length; x++) {\r\n                        entities.push(allResults[x]);\r\n                    }\r\n                    deferred.resolve(entities);\r\n                });\r\n            });\r\n\r\n            return deferred.promise;\r\n        }\r\n\r\n        public save = () => {\r\n            \r\n            var deferred = this.$q.defer();\r\n            var _entity = this;\r\n            var promises = [];\r\n            if (this.isValid()) {\r\n                if (this.id) {\r\n                    promises.push(this.dataService.update(this));\r\n                } else {\r\n                    promises.push(this.dataService.add(this));\r\n                }\r\n            } else {\r\n                deferred.reject();\r\n            }\r\n\r\n            this.$q.all(promises).then((results) => {\r\n                this.instance(results[0].data).then((results) => {\r\n                    _entity = results;\r\n                    _entity.notifySaved();\r\n                    deferred.resolve(_entity);\r\n                });\r\n            }).catch(() => {\r\n                deferred.reject();\r\n            });\r\n\r\n            return deferred.promise;\r\n        }\r\n\r\n        public remove = () => {\r\n            var deferred = this.$q.defer();\r\n\r\n            if (this.id) {\r\n                this.dataService.remove(this.id).then(() => {\r\n                    this.isDeleted = true;\r\n                    this.notifyDeleted();\r\n                    deferred.resolve();\r\n                });\r\n            } else {\r\n                deferred.reject();\r\n            } \r\n\r\n            return deferred.promise;\r\n        }\r\n\r\n        public isValid = ():boolean => {\r\n            if (this.getValidationErrors().length < 1) {\r\n                return true;\r\n            }\r\n            return false;\r\n        }\r\n\r\n        public notifySaved = () => {\r\n            this.notifyChanged(\"saved\");\r\n        }\r\n\r\n        public notifyDeleted = () => {\r\n            this.notifyChanged(\"deleted\");\r\n        }\r\n\r\n        public notifyChanged(changeType:string) {\r\n            this.notify(\"entityChanged\",{ target: this, changeType: changeType });\r\n        }\r\n\r\n        public notify(customeEventName: string, detailArg:any) {\r\n            var event = document.createEvent('CustomEvent');\r\n            event.initCustomEvent(customeEventName, false, false, detailArg);\r\n            document.dispatchEvent(event);\r\n        }\r\n\r\n        public instance = (data: any): ng.IPromise<any> => {\r\n            throw new Error(\"Not Implemented\");\r\n        }\r\n\r\n        public getValidationErrors = (): string[]=> {\r\n            throw new Error(\"Not Implemented\");\r\n        }\r\n    }\r\n} "]}