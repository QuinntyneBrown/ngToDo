{"version":3,"sources":["entity.ts"],"names":["app","app.common","app.common.Entity","app.common.Entity.constructor"],"mappings":"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","file":"entity.js","sourceRoot":"C:/Projects/ngToDo/ngToDo/","sourcesContent":["module app.common {\r\n\r\n    export class Entity<T> implements IEntity<T> {\r\n\r\n        constructor(public $location, public $q: ng.IQService, public fire:IFire, private dataService: common.IDataService, public entityName: string) {\r\n            this.id = 0;\r\n            this.isDeleted = false;\r\n        }\r\n\r\n        public id: number;\r\n\r\n        public isDeleted: boolean;\r\n\r\n        public getById = (id:any) => {\r\n\r\n            var deferred = this.$q.defer();\r\n\r\n            this.dataService.getById(id).then((results) => {\r\n                var entity:T = null;\r\n\r\n                this.instance(results.data).then((results) => {\r\n                    entity = results;\r\n                    deferred.resolve(entity);\r\n                });\r\n\r\n                \r\n            });\r\n\r\n            return deferred.promise;\r\n        }\r\n\r\n        public getAll = () => {\r\n\r\n            var deferred = this.$q.defer();\r\n\r\n            this.dataService.getAll().then((results) => {\r\n                var entities = [];\r\n\r\n                var promises = [];\r\n\r\n                results.data.forEach((result) => { promises.push(this.instance(result)); });\r\n\r\n                this.$q.all(promises).then((allResults) => {\r\n\r\n                    allResults.forEach((result) => { entities.push(result); });\r\n\r\n                    deferred.resolve(entities);\r\n                });\r\n            });\r\n\r\n            return deferred.promise;\r\n        }\r\n\r\n        public save = () => {\r\n            \r\n            var deferred = this.$q.defer();\r\n\r\n            var promises = [];\r\n\r\n            var action: string;\r\n\r\n            if (this.isValid()) {\r\n                if (this.id) {\r\n                    action = \"update\";\r\n                    promises.push(this.dataService.update(this));\r\n                } else {\r\n                    action = \"add\";\r\n                    promises.push(this.dataService.add(this));\r\n                }\r\n            } else {\r\n                deferred.reject();\r\n            }\r\n\r\n            this.$q.all(promises).then((results) => {\r\n                this.instance(results[0].data).then((results) => {                    \r\n                    this.fire(document.getElementsByTagName(\"body\")[0], this.entityName + \"Saved\", { entity: this, action: action });\r\n                    deferred.resolve();\r\n                });\r\n            }).catch(() => {\r\n                deferred.reject();\r\n            });\r\n\r\n            return deferred.promise;\r\n        }\r\n\r\n        public remove = () => {\r\n            var deferred = this.$q.defer();\r\n\r\n            if (this.id) {\r\n                this.dataService.remove(this.id).then(() => {         \r\n                    this.fire(document.getElementsByTagName(\"body\")[0], this.entityName + \"Removed\", { entity: this, action: \"remove\" });           \r\n                    deferred.resolve();\r\n                });\r\n            } else {\r\n                deferred.reject();\r\n            } \r\n\r\n            return deferred.promise;\r\n        }\r\n\r\n        public isValid = ():boolean => {\r\n            if (this.getValidationErrors().length < 1) {\r\n                return true;\r\n            }\r\n            return false;\r\n        }\r\n\r\n\r\n        public instance = (data: any): ng.IPromise<any> => {\r\n            throw new Error(\"Not Implemented\");\r\n        }\r\n\r\n        public getValidationErrors = (): string[]=> {\r\n            throw new Error(\"Not Implemented\");\r\n        }\r\n    }\r\n} "]}